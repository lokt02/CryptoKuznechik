CryptoKuznechik

Вопросы:
1.Откуда беруться значения в таблице для линейного преобразования?

ЧТО МЫ ПОНЯЛИ ИЗ ТОГО КАК ЭТО ВООБЩЕ ДЕЛАТЬ
1. Требуется посчитать ключи 10 штук (это будет раскрыто далее)
2. Требуется зашифровать текст (раскрыто далее)


Раскрытие пункта 1


Для того, чтобы рассчитать ключи требуется Получаем К1 и К2


Происходит рассчет константы 1 для получения дальнейших раундовых ключей. Рассчёт таков. Имеем номер итерациидалее записываем номер в 16 ричной системе. Тк требутся блок 16 байт мы дописываем к числу справа 15 0-ых байт. Далее происходит линейное преобразование с помощью таблицы  (148, 32, 133, 16, 194, 192, 1, 251, 1, 192, 194, 16, 133, 32, 148, 1). Эту штуку мы проворачиваем 16 раз. Таким образом мы получаем первую константу. Так нам нужно получить константы на каждую итерацию. Таким образом мы нагенерируем 32 константы.


СХЕМА 1
![image alt](https://habrastorage.org/webt/yi/0s/uq/yi0suq1zdi4iqmae1k5xxpuww38.png)
После того как мы получили два первых итерационных ключа. Функция, через которую проходит ключ это - сначала ксор с константой, нелинейное преобразование согласно таблице 1. затем провести линейное преобразование. Затем ксорим со вторым ключём внутри пары. Меняем ключи местами и генерим 10 хитрых ключей.


ТАБЛИЦА 1
![image alt](https://habrastorage.org/webt/wv/ju/6s/wvju6sacdo6hsdnrdurixzfpihs.jpeg)


Раскрытие пункта 2
10 раз требуется (ксорить текст с ключём, нелинейно преобразовать, линейно преобразовать)
И мы получаем шифротекст


С ЭТИМ КОНЕЦ.

ПРИМЕЧАНИЯ ПО ПОВОДУ ПРЕОБРАЗОВАНИЙ.

Линейное преобразование.

Имеем число 1. На него сначала смотрим как на 01 в 16 ричной системе. Далее добаляем до 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00. Далее с помощью таблицы (148, 32, 133, 16, 194, 192, 1, 251, 1, 192, 194, 16, 133, 32, 148, 1). Дальнейшее преобразование происходит таким образом:
1. Мы видим что a15 = 1 значит, после умножения а15 на соответствующее значение в таблице(1) и сдвига нашего блока влево получается 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01
2. Теперь мы видим , что а1=01 его требуется умножить на 148 (в соответствии с таблицей) итог: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 94
3. Дальейшее умножение (как и ранее будет происходить в поле Галуа) А это мы уже понимаем.

Нелинейное преобразование.

берём число в 16 ричной. Переводим в 10тичную. Смотрим на таблицу. Ищем ближайшее меньшее по строкам. Далее по столбцам ищем число, которое требуется прибавить к строковому. Там на пересечении есть конкретное значение. Оно - итог преобразования. 


